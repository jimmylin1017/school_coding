/\(\([a-z]\)[^a-z]*[a-z]\?@[^a-z]*\2\)\([^\n]*\)/!d
s//@\3\n\1/
b B

:A


:B
h
/\(\([a-z]\)[^a-z]*[a-z]\?@[^a-z]*\2\)/ s/\n\(\([a-z]\)[^a-z]*[a-z]\?@[^a-z]*\2\)//
x
/\(\([a-z]\)[^a-z]*[a-z]\?@[^a-z]*\2\)/ s/.*\n//

b C
:C

/\(\([a-z]\)[^a-z]*[a-z]\?@[^a-z]*\2\)/ s/\(\([a-z]\)[^a-z]*[a-z]\?\)@[^a-z]*\(\2\)\n\(\([a-z]\)[^a-z]*[a-z]\?\)@[^a-z]*\(\5\)/\1\4@\6\3/p
x
s/\(\([a-z]\)[^a-z]*[a-z]\?@[^a-z]*\2\)\([^\n]*\)/@\3\n\1/
t A
x
s/@//